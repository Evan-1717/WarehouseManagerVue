(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c49cb"],{"3c27":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{height:"100%"}},[t("div",{staticStyle:{"margin-bottom":"5px"}},[t("el-form",{ref:"form1",attrs:{model:e.form1,"label-width":"75px"}},[t("el-col",{attrs:{span:4}},[t("el-form-item",{attrs:{label:"起止日期",prop:"creater"}},[t("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",placeholder:"起始时间","value-format":"yyyy-MM-dd"},model:{value:e.form1.date1,callback:function(t){e.$set(e.form1,"date1",t)},expression:"form1.date1"}}),e._v("- "),t("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",placeholder:"结束时间","value-format":"yyyy-MM-dd"},model:{value:e.form1.date2,callback:function(t){e.$set(e.form1,"date2",t)},expression:"form1.date2"}})],1)],1),t("el-col",{attrs:{span:3}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2!=e.user.roleId,expression:"user.roleId!=2"}],attrs:{label:"记录人",prop:"creater"}},[t("el-select",{staticStyle:{width:"170px"},attrs:{filterable:"",clearable:"",multiple:"","collapse-tags":"",placeholder:"请选择"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadPost.apply(null,arguments)}},model:{value:e.form1.creater,callback:function(t){e.$set(e.form1,"creater",t)},expression:"form1.creater"}},e._l(e.users,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),t("el-col",{attrs:{span:3}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2!=e.user.roleId,expression:"user.roleId!=2"}],attrs:{label:"角色",prop:"role"}},[t("el-select",{staticStyle:{width:"170px"},attrs:{multiple:"",clearable:"","collapse-tags":"",placeholder:"请选择"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadPost.apply(null,arguments)}},model:{value:e.form1.role,callback:function(t){e.$set(e.form1,"role",t)},expression:"form1.role"}},e._l(e.roles,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),t("el-col",{attrs:{span:3}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2!=e.user.roleId,expression:"user.roleId!=2"}],attrs:{label:"位置",prop:"location"}},[t("el-select",{staticStyle:{width:"170px"},attrs:{"collapse-tags":"",placeholder:"请选择",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadPost.apply(null,arguments)}},model:{value:e.form1.location,callback:function(t){e.$set(e.form1,"location",t)},expression:"form1.location"}},e._l(e.locations,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:3}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2!=e.user.roleId,expression:"user.roleId!=2"}],attrs:{label:"内容",prop:"content"}},[t("el-select",{staticStyle:{width:"170px"},attrs:{"collapse-tags":"",placeholder:"请选择",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadPost.apply(null,arguments)}},model:{value:e.form1.content,callback:function(t){e.$set(e.form1,"content",t)},expression:"form1.content"}},e._l(e.contents,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:4}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2!=e.user.roleId,expression:"user.roleId!=2"}],attrs:{label:"入职时间",prop:"creater"}},[t("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",placeholder:"起始时间","value-format":"yyyy-MM-dd"},model:{value:e.form1.hiredate1,callback:function(t){e.$set(e.form1,"hiredate1",t)},expression:"form1.hiredate1"}}),e._v("- "),t("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",placeholder:"结束时间","value-format":"yyyy-MM-dd"},model:{value:e.form1.hiredate2,callback:function(t){e.$set(e.form1,"hiredate2",t)},expression:"form1.hiredate2"}})],1)],1)],1),t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.loadPost}},[e._v("查询")]),t("el-button",{attrs:{type:"success"},on:{click:e.resetParam}},[e._v("重置")]),t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.add}},[e._v("新增")]),t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.exportExcelTopNovel}},[e._v("导出最热小说")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:2!=e.user.roleId,expression:"user.roleId!=2"}],staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:function(t){return e.aiAnalyze("first")}}},[e._v("AI分析")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:2!=e.user.roleId,expression:"user.roleId!=2"}],staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.exportExcel}},[e._v("导出")])],1),t("el-table",{staticStyle:{overflow:"auto"},attrs:{data:e.tableData,"summary-method":e.getSummaries,"show-summary":"","header-cell-style":e.cell_style,border:"","max-height":"calc(100% - 200px)"}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"50",fixed:"left"}}),t("el-table-column",{attrs:{prop:"date",label:"日期",width:"100",fixed:"left"}}),t("el-table-column",{attrs:{prop:"creater",label:"记录人",width:"80",fixed:"left"}}),2!=e.user.roleId?t("el-table-column",{attrs:{prop:"role",label:"角色",width:"50",fixed:"left"}}):e._e(),2!=e.user.roleId?t("el-table-column",{attrs:{prop:"location",label:"位置",width:"100",fixed:"left"}}):e._e(),2!=e.user.roleId?t("el-table-column",{attrs:{prop:"content",label:"内容",width:"100",fixed:"left"}}):e._e(),2!=e.user.roleId?t("el-table-column",{attrs:{prop:"hiredate",label:"入职时间",width:"100",fixed:"left"}}):e._e(),t("el-table-column",{attrs:{prop:"dianzhongexpend",label:"点众消耗",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"dianzhongrecharge",label:"点众充值",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"dianzhongroi",label:"点众ROI",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"dianzhongmargin",label:"点众盈亏",width:"100",sortable:!0}}),2!=e.user.roleId?t("el-table-column",{attrs:{prop:"dianzhongprofit",label:"点众毛利",width:"100",sortable:!0}}):e._e(),t("el-table-column",{attrs:{prop:"heiyanexpend",label:"黑岩消耗",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"heiyanrecharge",label:"黑岩充值",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"heiyanroi",label:"黑岩ROI",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"heiyanmargin",label:"黑岩盈亏",width:"100",sortable:!0}}),2!=e.user.roleId?t("el-table-column",{attrs:{prop:"heiyanprofit",label:"黑岩毛利",width:"100",sortable:!0}}):e._e(),t("el-table-column",{attrs:{prop:"fanqieexpend",label:"番茄消耗",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"fanqierecharge",label:"番茄充值",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"fanqieroi",label:"番茄ROI",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"fanqiemargin",label:"番茄盈亏",width:"100",sortable:!0}}),2!=e.user.roleId?t("el-table-column",{attrs:{prop:"fanqieprofit",label:"番茄毛利",width:"100",sortable:!0}}):e._e(),t("el-table-column",{attrs:{prop:"qimaoexpend",label:"七猫消耗",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"qimaorecharge",label:"七猫充值",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"qimaoroi",label:"七猫ROI",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"qimaomargin",label:"七猫盈亏",width:"100",sortable:!0}}),2!=e.user.roleId?t("el-table-column",{attrs:{prop:"qimaoprofit",label:"七猫毛利",width:"100",sortable:!0}}):e._e(),2!=e.user.roleId?t("el-table-column",{attrs:{prop:"zongexpend",label:"总消耗",width:"90",sortable:!0}}):e._e(),t("el-table-column",{attrs:{prop:"zongroi",label:"总ROI",width:"90",sortable:!0}}),t("el-table-column",{attrs:{prop:"zongmargin",label:"总盈亏",width:"90",sortable:!0}}),2!=e.user.roleId?t("el-table-column",{attrs:{prop:"zongprofit",label:"总毛利",width:"90",sortable:!0}}):e._e(),t("el-table-column",{attrs:{prop:"time",label:"记录时间",width:"150"}}),t("el-table-column",{attrs:{prop:"operate",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{size:"small",type:"success"},on:{click:function(t){return e.mod(r.row)}}},[e._v("编辑")]),t("el-popconfirm",{staticStyle:{"margin-left":"5px"},attrs:{title:"确定删除吗？"},on:{confirm:function(t){return e.del(r.row.id)}}},[t("el-button",{attrs:{slot:"reference",size:"small",type:"danger"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),t("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[10,20,50,1e3],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("el-dialog",{attrs:{title:"提示",visible:e.centerDialogVisible,width:"31%",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[t("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"140px"}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"日期",prop:"date"}},[t("el-date-picker",{staticStyle:{width:"180px"},attrs:{type:"date","value-format":"yyyy-MM-dd"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"点众消耗",prop:"dianzhongexpend"}},[t("el-input-number",{attrs:{precision:2,step:.01,min:0},model:{value:e.form.dianzhongexpend,callback:function(t){e.$set(e.form,"dianzhongexpend",t)},expression:"form.dianzhongexpend"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"点众充值",prop:"dianzhongrecharge"}},[t("el-input-number",{attrs:{precision:2,step:.01,min:0},model:{value:e.form.dianzhongrecharge,callback:function(t){e.$set(e.form,"dianzhongrecharge",t)},expression:"form.dianzhongrecharge"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"黑岩消耗",prop:"heiyanexpend"}},[t("el-input-number",{attrs:{precision:2,step:.01,min:0},model:{value:e.form.heiyanexpend,callback:function(t){e.$set(e.form,"heiyanexpend",t)},expression:"form.heiyanexpend"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"黑岩充值",prop:"heiyanrecharge"}},[t("el-input-number",{attrs:{precision:2,step:.01,min:0},model:{value:e.form.heiyanrecharge,callback:function(t){e.$set(e.form,"heiyanrecharge",t)},expression:"form.heiyanrecharge"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"番茄消耗",prop:"fanqieexpend"}},[t("el-input-number",{attrs:{precision:2,step:.01,min:0},model:{value:e.form.fanqieexpend,callback:function(t){e.$set(e.form,"fanqieexpend",t)},expression:"form.fanqieexpend"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"番茄充值",prop:"fanqierecharge"}},[t("el-input-number",{attrs:{precision:2,step:.01,min:0},model:{value:e.form.fanqierecharge,callback:function(t){e.$set(e.form,"fanqierecharge",t)},expression:"form.fanqierecharge"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"七猫消耗",prop:"qimaoexpend"}},[t("el-input-number",{attrs:{precision:2,step:.01,min:0},model:{value:e.form.qimaoexpend,callback:function(t){e.$set(e.form,"qimaoexpend",t)},expression:"form.qimaoexpend"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"七猫充值",prop:"qimaorecharge"}},[t("el-input-number",{attrs:{precision:2,step:.01,min:0},model:{value:e.form.qimaorecharge,callback:function(t){e.$set(e.form,"qimaorecharge",t)},expression:"form.qimaorecharge"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"提问",visible:e.aiAskDialogVisible,width:"31%",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.aiAskDialogVisible=t}}},[t("el-form",{ref:"formAiAskRef",attrs:{rules:e.rules,model:e.formAiAsk,"label-width":"140px"}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"请输入问题:",prop:"ask"}},[t("el-input",{staticStyle:{width:"400px"},attrs:{precision:2},model:{value:e.formAiAsk.ask,callback:function(t){e.$set(e.formAiAsk,"ask",t)},expression:"formAiAsk.ask"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.aiAskDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.ask}},[e._v("确 定")])],1)],1),t("el-dialog",{staticStyle:{"max-height":"100%"},attrs:{title:e.question,visible:e.aiAnswerDialogVisible,width:"40%",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.aiAnswerDialogVisible=t},close:function(t){return e.aiAnswerClose()}}},[t("div",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.aiAnswer))]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.aiAnswerDialogVisible=!1}}},[e._v("退出提问")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.aiAnalyze("other")}}},[e._v("继续提问")])],1)])],1)},a=[],o={name:"NovelManage",data(){return{user:JSON.parse(sessionStorage.getItem("CurUser")),question:"问题",formAiAsk:{ask:""},aiAskDialogVisible:!1,aiAnswerDialogVisible:!1,aiAnswer:"",tableData:[],pageSize:10,pageNum:1,total:0,name:"",centerDialogVisible:!1,form:{id:"",date:"",dianzhongexpend:0,dianzhongrecharge:0,dianzhongroi:0,dianzhongprofit:0,dianzhongmargin:0,heiyanexpend:0,heiyanrecharge:0,heiyanroi:0,heiyanprofit:0,heiyanmargin:0,fanqieexpend:0,fanqierecharge:0,fanqieroi:0,fanqiemargin:0,fanqieprofit:0,qimaoexpend:0,qimaorecharge:0,qimaoroi:0,qimaomargin:0,qimaoprofit:0,zongmargin:0,zongexpend:0,zongroi:0,zongprofit:0,time:"",creater:""},form1:{date1:"",date2:"",hiredate1:"",hiredate2:"",location:"",content:"",creater:[JSON.parse(sessionStorage.getItem("CurUser")).name],role:[]},rules:{date:[{required:!0,trigger:"blur"}]},locations:[{value:"1903",label:"1903"},{value:"907",label:"907"}],contents:[{value:"番茄",label:"番茄"},{value:"点众",label:"点众"},{value:"小说",label:"小说"},{value:"腾讯",label:"腾讯"},{value:"iaa",label:"iaa"}],users:[],roles:[],modRow:{}}},methods:{getInputInfo(){this.$axios.get(this.$httpUrl+"/user/inputInfo").then(e=>e.data).then(e=>{200==e.code?(this.users=e.data.user,this.roles=e.data.role):this.$message({message:"操作失败！",type:"error"})})},aiAnswerClose(){},getSummaries(e){const{columns:t,data:r}=e,i=[];var a=0,o=0,s=0,n=0,l=0,h=0,m=0,d=0,f=0,c=0,p=0,u=0,g=0,b=0,x=0,y=0,v=0,k=0;for(var w of r)a+=w.dianzhongexpend,o+=w.dianzhongrecharge,s+=w.dianzhongmargin,n+=w.dianzhongprofit,l+=w.heiyanexpend,h+=w.heiyanrecharge,m+=w.heiyanmargin,d+=w.heiyanprofit,f+=w.fanqieexpend,c+=w.fanqierecharge,p+=w.fanqiemargin,u+=w.fanqieprofit,g+=w.qimaoexpend,b+=w.qimaorecharge,x+=w.qimaomargin,y+=w.qimaoprofit,v+=w.zongmargin,k+=w.zongprofit;return t.forEach((e,t)=>{2==this.user.roleId?0===t?i[t]="合计":3===t?i[t]=this.fixed2(a):4===t?i[t]=this.fixed2(o):5===t?i[t]=this.fixed(o/a*1.045):6===t?i[t]=this.fixed2(s):7===t?i[t]=this.fixed2(l):8===t?i[t]=this.fixed2(h):9===t?i[t]=this.fixed(h/l*1.045):10===t?i[t]=this.fixed2(m):11===t?i[t]=this.fixed2(f):12===t?i[t]=this.fixed2(c):13===t?i[t]=this.fixed(c/f*1.045):14===t?i[t]=this.fixed2(p):15===t?i[t]=this.fixed2(g):16===t?i[t]=this.fixed2(b):17===t?i[t]=this.fixed(b/g*1.045):18===t?i[t]=this.fixed2(x):19===t?i[t]=this.fixed((o+h+c+b)/(a+l+f+g)*1.045):20===t&&(i[t]=this.fixed2(v)):0===t?i[t]="合计":7===t?i[t]=this.fixed2(a):8===t?i[t]=this.fixed2(o):9===t?i[t]=this.fixed(o/a*1.045):10===t?i[t]=this.fixed2(s):11===t?i[t]=this.fixed2(n):12===t?i[t]=this.fixed2(l):13===t?i[t]=this.fixed2(h):14===t?i[t]=this.fixed(h/l*1.045):15===t?i[t]=this.fixed2(m):16===t?i[t]=this.fixed2(d):17===t?i[t]=this.fixed2(f):18===t?i[t]=this.fixed2(c):19===t?i[t]=this.fixed(c/f*1.045):20===t?i[t]=this.fixed2(p):21===t?i[t]=this.fixed2(u):22===t?i[t]=this.fixed2(g):23===t?i[t]=this.fixed2(b):24===t?i[t]=this.fixed(b/g*1.045):25===t?i[t]=this.fixed2(x):26===t?i[t]=this.fixed2(y):27===t?i[t]=this.fixed2(a+l+c+b):28===t?i[t]=this.fixed((o+h+c+b)/(a+l+f+g)*1.045):29===t?i[t]=this.fixed2(v):30===t&&(i[t]=this.fixed2(k))}),i},fixed(e){return Number(e).toFixed(4)},fixed2(e){return Number(e).toFixed(2)},cell_style({columnIndex:e}){return 2==this.user.roleId?3==e||4==e||5==e||6==e?"background:rgb(253,217,176);":7==e||8==e||9==e||10==e?"background:rgb(207,200,221);":11==e||12==e||13==e||14==e?"background:rgb(239,247,184);":15==e||16==e||17==e||18==e?"background:rgb(239,147,18);":19==e||20==e?"background:rgb(207,200,221);":"background:#f2f5fc;":7==e||8==e||9==e||10==e||11==e?"background:rgb(253,217,176);":12==e||13==e||14==e||15==e||16==e?"background:rgb(207,200,221);":17==e||18==e||19==e||20==e||21==e?"background:rgb(239,247,184);":22==e||23==e||24==e||25==e||26==e?"background:rgb(239,147,18);":27==e||28==e||29==e||30==e?"background:rgb(219,187,164);":"background:#f2f5fc;"},resetForm(){this.$refs.form.resetFields(),this.form.id=""},del(e){this.$axios.get(this.$httpUrl+"/novel/del?id="+e).then(e=>e.data).then(e=>{200==e.code?(this.$message({message:"操作成功！",type:"success"}),this.loadPost()):this.$message({message:"操作失败！",type:"error"})})},mod(e){this.centerDialogVisible=!0,this.$nextTick(()=>{this.form.id=e.id,this.form.date=e.date,this.form.dianzhongexpend=e.dianzhongexpend,this.form.dianzhongrecharge=e.dianzhongrecharge,this.form.heiyanexpend=e.heiyanexpend,this.form.heiyanrecharge=e.heiyanrecharge,this.form.fanqieexpend=e.fanqieexpend,this.form.fanqierecharge=e.fanqierecharge,this.form.qimaoexpend=e.qimaoexpend,this.form.qimaorecharge=e.qimaorecharge}),this.modRow=e},add(){this.centerDialogVisible=!0,this.$nextTick(()=>{this.resetForm()})},dealRoi(e){let t=0;t=new Date(e).getTime()>=new Date("2025-02-03").getTime()?.92:.9,this.form.dianzhongexpend?(this.form.dianzhongroi=this.fixed(this.form.dianzhongrecharge/this.form.dianzhongexpend*1.02),this.form.dianzhongmargin=this.fixed2(.85*this.form.dianzhongrecharge-this.form.dianzhongexpend/1.02),this.form.dianzhongprofit=this.fixed2(.9*this.form.dianzhongrecharge-this.form.dianzhongexpend/1.02)):(this.form.dianzhongroi=0,this.form.dianzhongmargin=0,this.form.dianzhongprofit=0),this.form.heiyanexpend?(this.form.heiyanroi=this.fixed(this.form.heiyanrecharge/this.form.heiyanexpend*1.02),this.form.heiyanmargin=this.fixed2(.85*this.form.heiyanrecharge-this.form.heiyanexpend/1.02),this.form.heiyanprofit=this.fixed2(this.form.heiyanrecharge*t-this.form.heiyanexpend/1.02)):(this.form.heiyanroi=0,this.form.heiyanmargin=0,this.form.heiyanprofit=0),this.form.fanqieexpend?(this.form.fanqieroi=this.fixed(this.form.fanqierecharge/this.form.fanqieexpend*1.02),this.form.fanqiemargin=this.fixed2(.85*this.form.fanqierecharge-this.form.fanqieexpend/1.02),this.form.fanqieprofit=this.fixed2(.9*this.form.fanqierecharge-this.form.fanqieexpend/1.02)):(this.form.fanqieroi=0,this.form.fanqiemargin=0,this.form.fanqieprofit=0),this.form.qimaoexpend?(this.form.qimaoroi=this.fixed(this.form.qimaorecharge/this.form.qimaoexpend*1.02),this.form.qimaomargin=this.fixed2(.85*this.form.qimaorecharge-this.form.qimaoexpend/1.02),this.form.qimaoprofit=this.fixed2(.9*this.form.qimaorecharge-this.form.qimaoexpend/1.02)):(this.form.qimaoroi=0,this.form.qimaomargin=0,this.form.qimaoprofit=0),this.form.dianzhongexpend+this.form.heiyanexpend+this.form.fanqieexpend+this.form.qimaoexpend!=0?(this.form.zongroi=this.fixed((this.form.dianzhongrecharge+ +this.form.heiyanrecharge+this.form.fanqierecharge+this.form.qimaorecharge)/(this.form.dianzhongexpend+this.form.heiyanexpend+this.form.fanqieexpend+this.form.qimaoexpend)*1.02),this.form.zongmargin=this.fixed2(.85*this.form.dianzhongrecharge+.85*this.form.heiyanrecharge+.85*this.form.fanqierecharge+.85*this.form.qimaorecharge-(this.form.dianzhongexpend+this.form.heiyanexpend+this.form.fanqieexpend+this.form.qimaoexpend)/1.02),this.form.zongprofit=this.fixed2(.9*this.form.dianzhongrecharge+this.form.heiyanrecharge*t+.9*this.form.fanqierecharge+.9*this.form.qimaorecharge-(this.form.dianzhongexpend+this.form.heiyanexpend+this.form.fanqieexpend+this.form.qimaoexpend)/1.02)):(this.form.zongroi=0,this.form.zongmargin=0,this.form.zongprofit=0),this.form.zongexpend=this.form.dianzhongexpend+this.form.heiyanexpend+this.form.fanqieexpend+this.form.qimaoexpend},doSave(){this.form.time=this.currentDate(),this.form.creater=this.user.name,this.$axios.post(this.$httpUrl+"/novel/checkrecord",this.form).then(e=>e.data).then(e=>{0==e.data.length?(this.dealRoi(this.form.date),this.$axios.post(this.$httpUrl+"/novel/save",this.form).then(e=>e.data).then(e=>{200==e.code?(this.$message({message:"操作成功！",type:"success"}),this.centerDialogVisible=!1,this.loadPost(),this.resetForm()):this.$message({message:"操作失败！",type:"error"})})):this.$message({message:this.form.date+"已录入数据！",type:"error"})})},exportExcel(){this.form.time=this.currentDate(),this.form.creater=this.user.name,this.$confirm("确定导出？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.request({url:this.$httpUrl+"/novel/export",method:"post",data:{date1:this.form1.date1,date2:this.form1.date2,location:this.form1.location,content:this.form1.content,hiredate1:this.form1.hiredate1,hiredate2:this.form1.hiredate2,creater:this.form1.creater,role:this.form1.role},responseType:"blob"}).then(e=>{const t=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=t,r.setAttribute("download","投放记录"+(new Date).getTime()+".xlsx"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(URL)}).catch(()=>{this.$message({message:"下载失败！",type:"error"})})})},ask(){this.question="问题: "+this.formAiAsk.ask;const e={date1:this.form1.date1,date2:this.form1.date2,location:this.form1.location,content:this.form1.content,hiredate1:this.form1.hiredate1,hiredate2:this.form1.hiredate2,creater:this.form1.creater,asker:this.user.name,ask:this.formAiAsk.ask,tableName:"novel",role:this.form1.role},t=this.$loading({lock:!0,text:"AI正在思考，清稍等！",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$axios.post(this.$httpUrl+"/deepseek/ask",e).then(e=>e.data).then(e=>{200==e.code?(this.aiAskDialogVisible=!1,this.aiAnswerDialogVisible=!0,this.aiAnswer=e.data,t.close()):this.$message({message:"操作失败！",type:"error"})})},aiAnalyze(e){this.formAiAsk.ask="",this.aiAnswerDialogVisible=!1,this.aiAnswer="",this.aiAskDialogVisible=!0,"first"==e&&this.$axios.post(this.$httpUrl+"/deepseek/clearAsk",{asker:this.user.name,tableName:"novel"})},exportExcelTopNovel(){this.form.time=this.currentDate(),this.form.creater=this.user.name,this.$confirm("确定导出？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.request({url:this.$httpUrl.replace("8002","8003")+"/novel/exporttopnovel",method:"post",data:{date1:this.form1.date1},responseType:"blob"}).then(e=>{const t=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=t,r.setAttribute("download","最热小说"+(new Date).getTime()+".xlsx"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(URL)}).catch(()=>{this.$message({message:"下载失败！",type:"error"})})})},currentDate(){var e=new Date,t=e.getFullYear(),r=e.getMonth();r=r+1>12?1:r+1,r=r>9?r:"0"+r.toString();var i=e.getDate(),a=e.getHours();a=a>9?a:"0"+a.toString();var o=e.getMinutes();o=o>9?o:"0"+o.toString();var s=e.getSeconds();return`${t}-${r}-${i} ${a}:${o}:${s}`},doMod(){this.form.time=this.currentDate(),this.dealRoi(this.form.date),this.form.creater=this.modRow.creater,this.$axios.post(this.$httpUrl+"/novel/update",this.form).then(e=>e.data).then(e=>{200==e.code?(this.$message({message:"操作成功！",type:"success"}),this.centerDialogVisible=!1,this.loadPost(),this.resetForm()):this.$message({message:"操作失败！",type:"error"})})},save(){this.$refs.form.validate(e=>{if(!e)return!1;this.form.id?this.doMod():this.doSave()})},handleSizeChange(e){this.pageNum=1,this.pageSize=e,this.loadPost()},handleCurrentChange(e){this.pageNum=e,this.loadPost()},resetParam(){this.form1.date1="",this.form1.date2="",this.form1.location="",this.form1.content="",this.form1.hiredate1="",this.form1.hiredate2="",2!=this.user.roleId?this.form1.creater=[]:this.form1.creater=[this.user.name]},loadPost(){this.$axios.post(this.$httpUrl+"/novel/listPage",{pageSize:this.pageSize,pageNum:this.pageNum,param:{date1:this.form1.date1,date2:this.form1.date2,location:this.form1.location,content:this.form1.content,hiredate1:this.form1.hiredate1,hiredate2:this.form1.hiredate2,creater:this.form1.creater,role:this.form1.role}}).then(e=>e.data).then(e=>{200==e.code?(this.tableData=e.data,this.total=e.total):alert("获取数据失败")})}},beforeMount(){2!=this.user.roleId?this.form1.creater=[]:this.form1.creater=[JSON.parse(sessionStorage.getItem("CurUser")).name],this.loadPost(),this.getInputInfo()}},s=o,n=r("2877"),l=Object(n["a"])(s,i,a,!1,null,"28e9ecfa",null);t["default"]=l.exports}}]);
//# sourceMappingURL=chunk-2d0c49cb.e38f9b89.js.map