(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d3e64"],{"5f74":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{height:"100%"}},[t("div",{staticStyle:{"margin-bottom":"5px"}},[t("el-form",{ref:"form1",attrs:{model:e.form,"label-width":"75px"}},[t("el-col",{attrs:{span:4}},[t("el-form-item",{attrs:{label:"创建起止日期",prop:"creater"}},[t("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",placeholder:"起始时间","value-format":"yyyy-MM-dd"},model:{value:e.form1.date1,callback:function(t){e.$set(e.form1,"date1",t)},expression:"form1.date1"}}),e._v("- "),t("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",placeholder:"结束时间","value-format":"yyyy-MM-dd"},model:{value:e.form1.date2,callback:function(t){e.$set(e.form1,"date2",t)},expression:"form1.date2"}})],1)],1),t("el-col",{attrs:{span:3}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2!=e.user.roleId,expression:"user.roleId!=2"}],attrs:{label:"记录人",prop:"creater"}},[t("el-select",{staticStyle:{width:"170px"},attrs:{filterable:"",clearable:"",multiple:"","collapse-tags":"",placeholder:"请选择"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loadPost.apply(null,arguments)}},model:{value:e.form1.creater,callback:function(t){e.$set(e.form1,"creater",t)},expression:"form1.creater"}},e._l(e.users,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),t("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.loadPost}},[e._v("查询")]),t("el-button",{attrs:{type:"success"},on:{click:e.resetParam}},[e._v("重置")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:2!=e.user.roleId,expression:"user.roleId!=2"}],staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:function(t){return e.aiAnalyze("first")}}},[e._v("AI分析")])],1),t("el-table",{staticStyle:{overflow:"auto"},attrs:{data:e.tableData,"summary-method":e.getSummaries,"show-summary":"",border:"","max-height":"calc(100% - 200px)"}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"50",fixed:"left"}}),t("el-table-column",{attrs:{prop:"date",label:"创建日期",width:"100",fixed:"left"}}),t("el-table-column",{attrs:{prop:"update_date",label:"更新日期",width:"100",fixed:"left"}}),t("el-table-column",{attrs:{prop:"advertiser_id",label:"创量账户ID",width:"150",fixed:"left"}}),t("el-table-column",{attrs:{prop:"media_account_name",label:"推广链名称",width:"500",fixed:"left"}}),t("el-table-column",{attrs:{prop:"fund_cost",label:"今日消耗",width:"100",fixed:"left"}}),t("el-table-column",{attrs:{prop:"fund_recharge",label:"今日充值",width:"100",fixed:"left"}}),t("el-table-column",{attrs:{prop:"stat_cost",label:"总消耗",width:"100",fixed:"left"}}),t("el-table-column",{attrs:{prop:"stat_pay_amount",label:"总充值",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"pay_amount_roi",label:"ROI",width:"100",fixed:"left"}}),t("el-table-column",{attrs:{prop:"media_source",label:"小程序",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"creater",label:"创建人",width:"100",sortable:!0}}),t("el-table-column",{attrs:{prop:"operate",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"success"},on:{click:function(t){return e.history(a.row)}}},[e._v("历史")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[10,20,50,1e3],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("el-dialog",{attrs:{title:"提问",visible:e.aiAskDialogVisible,width:"31%",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.aiAskDialogVisible=t}}},[t("el-form",{ref:"formAiAskRef",attrs:{rules:e.rules,model:e.formAiAsk,"label-width":"140px"}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"请输入问题:",prop:"ask"}},[t("el-input",{staticStyle:{width:"400px"},attrs:{precision:2},model:{value:e.formAiAsk.ask,callback:function(t){e.$set(e.formAiAsk,"ask",t)},expression:"formAiAsk.ask"}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.aiAskDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.ask}},[e._v("确 定")])],1)],1),t("el-dialog",{staticStyle:{"max-height":"100%"},attrs:{title:"历史信息",visible:e.aiAnswerDialogVisible,width:"40%",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.aiAnswerDialogVisible=t}}},[t("div",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.aiAnswer))]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.aiAnswerDialogVisible=!1}}},[e._v("退出提问")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.aiAnalyze("other")}}},[e._v("继续提问")])],1)]),t("el-dialog",{staticStyle:{"max-height":"100%"},attrs:{title:e.question,visible:e.historyDialogVisible,width:"30%",center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.historyDialogVisible=t}}},[t("div",[t("div",{staticStyle:{"white-space":"pre-wrap"}},[t("span",[e._v(" 充值：")]),e._l(e.daily_recharge,(function(a){return t("div",{key:a},[e._v(" "+e._s(a)+" ")])}))],2),t("div",{staticStyle:{"white-space":"pre-wrap"}},[t("span",[e._v(" 消耗：")]),e._l(e.daily_cost,(function(a){return t("div",{key:a},[e._v(" "+e._s(a)+" ")])}))],2)])])],1)},i=[],s={name:"AdvertiserManage",data(){return{user:JSON.parse(sessionStorage.getItem("CurUser")),question:"问题",formAiAsk:{ask:""},aiAskDialogVisible:!1,aiAnswerDialogVisible:!1,historyDialogVisible:!1,daily_cost:"",daily_recharge:"",aiAnswer:"",tableData:[],pageSize:10,pageNum:1,total:0,name:"",centerDialogVisible:!1,form:{id:"",date:"",update_date:"",advertiser_id:0,media_advertiser_nick:0,media_account_id:0,fund_cost:0,fund_recharge:0,stat_cost:0,pay_amount_roi:0,stat_pay_amount:0,fanqiefufeiroi:0,media_account_name:0,media_source:0,creater:0},form1:{date1:"",date2:"",creater:[JSON.parse(sessionStorage.getItem("CurUser")).name]},rules:{date:[{required:!0,trigger:"blur"}]},users:[],roles:[],modRow:{}}},methods:{history(e){this.historyDialogVisible=!0,this.daily_recharge=e.daily_recharge,this.daily_cost=e.daily_cost,console.log(e.daily_recharge),console.log(e.daily_cost)},getInputInfo(){this.$axios.get(this.$httpUrl+"/user/inputInfo").then(e=>e.data).then(e=>{200==e.code?(this.users=e.data.user,this.roles=e.data.role):this.$message({message:"操作失败！",type:"error"})})},ask(){this.question="问题: "+this.formAiAsk.ask;const e={date1:this.form1.date1,date2:this.form1.date2,creater:this.form1.creater,asker:this.user.name,ask:this.formAiAsk.ask,tableName:"advertiser",role:this.form1.role},t=this.$loading({lock:!0,text:"AI正在思考，清稍等！",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$axios.post(this.$httpUrl+"/deepseek/ask",e).then(e=>e.data).then(e=>{200==e.code?(this.aiAskDialogVisible=!1,this.aiAnswerDialogVisible=!0,this.aiAnswer=e.data,t.close()):this.$message({message:"操作失败！",type:"error"})})},aiAnalyze(e){this.formAiAsk.ask="",this.aiAnswerDialogVisible=!1,this.aiAnswer="",this.aiAskDialogVisible=!0,"first"==e&&this.$axios.post(this.$httpUrl+"/deepseek/clearAsk",{asker:this.user.name,tableName:"advertiser"})},getSummaries(e){const{columns:t,data:a}=e,r=[];var i=0,s=0;for(var o of a)i+=o.fund_cost,s+=o.stat_cos;return t.forEach((e,t)=>{2==this.user.roleId&&(0===t?r[t]="合计":4===t?r[t]=this.fixed2(i):6===t&&(r[t]=this.fixed2(s)))}),r},fixed(e){return Number(e).toFixed(4)},fixed2(e){return Number(e).toFixed(2)},resetForm(){this.$refs.form.resetFields(),this.form.id=""},exportExcel(){this.form.time=this.currentDate(),this.form.creater=this.user.name,this.$confirm("确定导出？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$axios.request({url:this.$httpUrl+"/advertiser/export",method:"post",data:{date1:this.form1.date1,date2:this.form1.date2,location:this.form1.location,content:this.form1.content,hiredate1:this.form1.hiredate1,hiredate2:this.form1.hiredate2,creater:this.form1.creater,role:this.form1.role},responseType:"blob"}).then(e=>{const t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","投放记录"+(new Date).getTime()+".xlsx"),document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(URL)}).catch(()=>{this.$message({message:"下载失败！",type:"error"})})})},currentDate(){var e=new Date,t=e.getFullYear(),a=e.getMonth();a=a+1>12?1:a+1,a=a>9?a:"0"+a.toString();var r=e.getDate(),i=e.getHours();i=i>9?i:"0"+i.toString();var s=e.getMinutes();s=s>9?s:"0"+s.toString();var o=e.getSeconds();return`${t}-${a}-${r} ${i}:${s}:${o}`},handleSizeChange(e){this.pageNum=1,this.pageSize=e,this.loadPost()},handleCurrentChange(e){this.pageNum=e,this.loadPost()},resetParam(){this.form1.date1="",this.form1.date2="",this.form1.location="",this.form1.content="",this.form1.hiredate1="",this.form1.hiredate2="",2!=this.user.roleId?this.form1.creater=[]:this.form1.creater=[this.user.name]},loadPost(){this.$axios.post(this.$httpUrl+"/advertiser/listPage",{pageSize:this.pageSize,pageNum:this.pageNum,param:{date1:this.form1.date1,date2:this.form1.date2,location:this.form1.location,content:this.form1.content,hiredate1:this.form1.hiredate1,hiredate2:this.form1.hiredate2,creater:this.form1.creater,role:this.form1.role}}).then(e=>e.data).then(e=>{200==e.code?(this.tableData=e.data,this.total=e.total):alert("获取数据失败")})}},beforeMount(){2!=this.user.roleId?this.form1.creater=[]:this.form1.creater=[JSON.parse(sessionStorage.getItem("CurUser")).name],this.loadPost(),this.getInputInfo()}},o=s,l=a("2877"),n=Object(l["a"])(o,r,i,!1,null,"8cca2fe0",null);t["default"]=n.exports}}]);
//# sourceMappingURL=chunk-2d0d3e64.97e4275c.js.map